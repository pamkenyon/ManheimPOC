require('source-map-support').install();

/* global describe:true, it:true */

'use strict';

var _extends = require('babel-runtime/helpers/extends')['default'];

var _slicedToArray = require('babel-runtime/helpers/sliced-to-array')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _ = require('../..');

var _mockRequest = require('./mock-request');

var _mockRequest2 = _interopRequireDefault(_mockRequest);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var should = _chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

function buildReqRes(url, method, body) {
  var req = { originalUrl: url, method: method, body: body };
  var res = {};
  res.headers = {};
  res.set = function (k, v) {
    res[k] = v;
  };
  res.status = function (code) {
    res.sentCode = code;
    return res;
  };
  res.send = function (body) {
    try {
      body = JSON.parse(body);
    } catch (e) {}
    res.sentBody = body;
  };
  return [req, res];
}

function mockProxy() {
  var opts = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

  var proxy = new _.JWProxy(opts);
  proxy.request = function callee$1$0() {
    var args$2$0 = arguments;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(_mockRequest2['default'].apply(undefined, args$2$0));

        case 2:
          return context$2$0.abrupt('return', context$2$0.sent);

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  };
  return proxy;
}

describe('proxy', function () {
  it('should override default params', function () {
    var j = mockProxy({ server: '127.0.0.2' });
    j.server.should.equal('127.0.0.2');
    j.port.should.equal(4444);
  });
  it('should save session id on session creation', function callee$1$0() {
    var j, _ref, _ref2, res, body;

    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          j = mockProxy();
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(j.proxy('/session', 'POST', { desiredCapabilities: {} }));

        case 3:
          _ref = context$2$0.sent;
          _ref2 = _slicedToArray(_ref, 2);
          res = _ref2[0];
          body = _ref2[1];

          res.statusCode.should.equal(200);
          body.should.eql({ status: 0, sessionId: '123', value: { browserName: 'boo' } });
          j.sessionId.should.equal('123');

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });
  it('should save session id on session creation with 303', function callee$1$0() {
    var j, _ref3, _ref32, res, body;

    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          j = mockProxy();
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(j.proxy('/session', 'POST', { desiredCapabilities: { redirect: true } }));

        case 3:
          _ref3 = context$2$0.sent;
          _ref32 = _slicedToArray(_ref3, 2);
          res = _ref32[0];
          body = _ref32[1];

          res.statusCode.should.equal(303);
          body.should.eql('http://localhost:4444/wd/hub/session/123');
          j.sessionId.should.equal('123');

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });
  describe('getUrlForProxy', function () {
    it('should modify session id, host, and port', function callee$2$0() {
      var j;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });

            j.getUrlForProxy('http://host.com:1234/wd/hub/session/456/element/200/value').should.eql('http://localhost:4444/wd/hub/session/123/element/200/value');

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should prepend scheme, host and port if not provided', function callee$2$0() {
      var j;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });

            j.getUrlForProxy('/wd/hub/session/456/element/200/value').should.eql('http://localhost:4444/wd/hub/session/123/element/200/value');

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should work with urls which do not have session ids', function callee$2$0() {
      var j, newUrl;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });

            j.getUrlForProxy('http://host.com:1234/wd/hub/session').should.eql('http://localhost:4444/wd/hub/session');

            newUrl = j.getUrlForProxy('/wd/hub/session');

            newUrl.should.eql('http://localhost:4444/wd/hub/session');

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw an error if url requires a sessionId but its null', function callee$2$0() {
      var j, e;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy();
            e = undefined;

            try {
              j.getUrlForProxy('/wd/hub/session/456/element/200/value');
            } catch (err) {
              e = err;
            }
            should.exist(e);
            e.message.should.contain('without session id');

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should not throw an error if url does not require a session id and its null', function callee$2$0() {
      var j, newUrl;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy();
            newUrl = j.getUrlForProxy('/wd/hub/status');

            should.exist(newUrl);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('straight proxy', function () {
    it('should successfully proxy straight', function callee$2$0() {
      var j, _ref4, _ref42, res, body;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy();
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(j.proxy('/status', 'GET'));

          case 3:
            _ref4 = context$3$0.sent;
            _ref42 = _slicedToArray(_ref4, 2);
            res = _ref42[0];
            body = _ref42[1];

            res.statusCode.should.equal(200);
            body.should.eql({ status: 0, value: { foo: 'bar' } });

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should pass along request errors', function callee$2$0() {
      var j;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });

            j.proxy('/badurl', 'GET').should.eventually.be.rejectedWith("Could not proxy");

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should proxy error responses and codes', function callee$2$0() {
      var j, _ref5, _ref52, res, body;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(j.proxy('/element/bad/text', 'GET'));

          case 3:
            _ref5 = context$3$0.sent;
            _ref52 = _slicedToArray(_ref5, 2);
            res = _ref52[0];
            body = _ref52[1];

            res.statusCode.should.equal(500);
            body.should.eql({ status: 11, value: { message: 'Invisible element' } });

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('getTimeoutRequestObjects', function () {
    var j = undefined;
    before(function () {
      j = mockProxy();
    });
    it('should take W3C inputs and produce MJSONWP + W3C compatible objects', function callee$2$0() {
      var timeoutObjects;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(j.getTimeoutRequestObjects({ protocol: 'W3C', script: 100 }));

          case 2:
            timeoutObjects = context$3$0.sent;

            timeoutObjects.length.should.equal(1);
            timeoutObjects[0].should.eql({ script: 100, pageLoad: undefined, implicit: undefined, type: 'script', ms: 100 });

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should take multiple W3C timeouts and produce multiple MJSONWP + W3C compatible objects', function callee$2$0() {
      var _ref6, _ref62, scriptTimeout, pageLoadTimeout, implicitTimeout, expectedObjBase;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(j.getTimeoutRequestObjects({ protocol: 'W3C', script: 100, pageLoad: 200, implicit: 300 }));

          case 2:
            _ref6 = context$3$0.sent;
            _ref62 = _slicedToArray(_ref6, 3);
            scriptTimeout = _ref62[0];
            pageLoadTimeout = _ref62[1];
            implicitTimeout = _ref62[2];
            expectedObjBase = { script: 100, pageLoad: 200, implicit: 300 };

            scriptTimeout.should.eql(_extends({}, expectedObjBase, {
              type: 'script',
              ms: 100
            }));
            pageLoadTimeout.should.eql(_extends({}, expectedObjBase, {
              type: 'pageLoad',
              ms: 200
            }));
            implicitTimeout.should.eql(_extends({}, expectedObjBase, {
              type: 'implicit',
              ms: 300
            }));

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should create W3C timeouts from MJSONWP inputs', function callee$2$0() {
      var _ref7, _ref72, timeoutObject;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(j.getTimeoutRequestObjects({ protocol: 'MJSONWP', type: 'script', ms: 200 }));

          case 2:
            _ref7 = context$3$0.sent;
            _ref72 = _slicedToArray(_ref7, 1);
            timeoutObject = _ref72[0];

            timeoutObject.should.eql({
              script: 200,
              pageLoad: undefined,
              implicit: undefined,
              type: 'script',
              ms: 200
            });

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
  describe('command proxy', function () {
    it('should successfully proxy command', function callee$2$0() {
      var j, res;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy();
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(j.command('/status', 'GET'));

          case 3:
            res = context$3$0.sent;

            res.should.eql({ foo: 'bar' });

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should pass along request errors', function callee$2$0() {
      var j;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });

            j.command('/badurl', 'GET').should.eventually.be.rejectedWith("Could not proxy");

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should throw when a command fails', function callee$2$0() {
      var j, e;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            e = null;
            context$3$0.prev = 2;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(j.command('/element/bad/text', 'GET'));

          case 5:
            context$3$0.next = 10;
            break;

          case 7:
            context$3$0.prev = 7;
            context$3$0.t0 = context$3$0['catch'](2);

            e = context$3$0.t0;

          case 10:
            should.exist(e);
            e.message.should.contain('Invisible element');

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this, [[2, 7]]);
    });
    it('should throw when a command fails with a 200 because the status is not 0', function callee$2$0() {
      var j, e;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            e = null;
            context$3$0.prev = 2;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(j.command('/element/200/text', 'GET'));

          case 5:
            context$3$0.next = 10;
            break;

          case 7:
            context$3$0.prev = 7;
            context$3$0.t0 = context$3$0['catch'](2);

            e = context$3$0.t0;

          case 10:
            should.exist(e);
            e.error.should.eql('element not visible');

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this, [[2, 7]]);
    });
    it('should throw when a command fails with a 100', function callee$2$0() {
      var j, e;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            e = null;
            context$3$0.prev = 2;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(j.command('/session/badchrome/nochrome', 'GET'));

          case 5:
            context$3$0.next = 10;
            break;

          case 7:
            context$3$0.prev = 7;
            context$3$0.t0 = context$3$0['catch'](2);

            e = context$3$0.t0;

          case 10:
            should.exist(e);
            e.message.should.contain('chrome not reachable');

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this, [[2, 7]]);
    });
  });
  describe('req/res proxy', function () {
    it('should successfully proxy via req and send to res', function callee$2$0() {
      var j, _buildReqRes, _buildReqRes2, req, res;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy();
            _buildReqRes = buildReqRes('/status', 'GET');
            _buildReqRes2 = _slicedToArray(_buildReqRes, 2);
            req = _buildReqRes2[0];
            res = _buildReqRes2[1];
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(j.proxyReqRes(req, res));

          case 7:
            res.headers['content-type'].should.equal('application/json; charset=utf-8');
            res.sentCode.should.equal(200);
            res.sentBody.should.eql({ status: 0, value: { foo: 'bar' } });

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should rewrite the inner session id so it doesnt change', function callee$2$0() {
      var j, _buildReqRes3, _buildReqRes32, req, res;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            _buildReqRes3 = buildReqRes('/element/200/value', 'GET');
            _buildReqRes32 = _slicedToArray(_buildReqRes3, 2);
            req = _buildReqRes32[0];
            res = _buildReqRes32[1];
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(j.proxyReqRes(req, res));

          case 7:
            res.sentBody.should.eql({ status: 0, value: 'foobar', sessionId: '123' });

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should rewrite the inner session id with sessionId in url', function callee$2$0() {
      var j, _buildReqRes4, _buildReqRes42, req, res;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            _buildReqRes4 = buildReqRes('/wd/hub/session/456/element/200/value', 'POST');
            _buildReqRes42 = _slicedToArray(_buildReqRes4, 2);
            req = _buildReqRes42[0];
            res = _buildReqRes42[1];
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(j.proxyReqRes(req, res));

          case 7:
            res.sentBody.should.eql({ status: 0, value: 'foobar', sessionId: '456' });

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should pass through urls that do not require session IDs', function callee$2$0() {
      var j, _buildReqRes5, _buildReqRes52, req, res;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            _buildReqRes5 = buildReqRes('/wd/hub/status', 'GET');
            _buildReqRes52 = _slicedToArray(_buildReqRes5, 2);
            req = _buildReqRes52[0];
            res = _buildReqRes52[1];
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(j.proxyReqRes(req, res));

          case 7:
            res.sentBody.should.eql({ status: 0, value: { 'foo': 'bar' } });

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    it('should proxy strange responses', function callee$2$0() {
      var j, _buildReqRes6, _buildReqRes62, req, res;

      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            j = mockProxy({ sessionId: '123' });
            _buildReqRes6 = buildReqRes('/nochrome', 'GET');
            _buildReqRes62 = _slicedToArray(_buildReqRes6, 2);
            req = _buildReqRes62[0];
            res = _buildReqRes62[1];
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(j.proxyReqRes(req, res));

          case 7:
            res.sentCode.should.equal(100);
            res.sentBody.should.eql({ status: 0, value: { message: 'chrome not reachable' } });

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvanNvbndwLXByb3h5L3Byb3h5LXNwZWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Z0JBR3dCLE9BQU87OzJCQUNYLGdCQUFnQjs7OztvQkFDbkIsTUFBTTs7Ozs4QkFDSSxrQkFBa0I7Ozs7QUFHN0MsSUFBTSxNQUFNLEdBQUcsa0JBQUssTUFBTSxFQUFFLENBQUM7QUFDN0Isa0JBQUssR0FBRyw2QkFBZ0IsQ0FBQzs7QUFFekIsU0FBUyxXQUFXLENBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDdkMsTUFBSSxHQUFHLEdBQUcsRUFBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBTixNQUFNLEVBQUUsSUFBSSxFQUFKLElBQUksRUFBQyxDQUFDO0FBQzNDLE1BQUksR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUNiLEtBQUcsQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQ2pCLEtBQUcsQ0FBQyxHQUFHLEdBQUcsVUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFLO0FBQUUsT0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztHQUFFLENBQUM7QUFDcEMsS0FBRyxDQUFDLE1BQU0sR0FBRyxVQUFDLElBQUksRUFBSztBQUNyQixPQUFHLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztBQUNwQixXQUFPLEdBQUcsQ0FBQztHQUNaLENBQUM7QUFDRixLQUFHLENBQUMsSUFBSSxHQUFHLFVBQUMsSUFBSSxFQUFLO0FBQ25CLFFBQUk7QUFDRixVQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUN6QixDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUU7QUFDZCxPQUFHLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztHQUNyQixDQUFDO0FBQ0YsU0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztDQUNuQjs7QUFFRCxTQUFTLFNBQVMsR0FBYTtNQUFYLElBQUkseURBQUcsRUFBRTs7QUFDM0IsTUFBSSxLQUFLLEdBQUcsY0FBWSxJQUFJLENBQUMsQ0FBQztBQUM5QixPQUFLLENBQUMsT0FBTyxHQUFHOzs7Ozs7MkNBQ0QsbURBQWdCOzs7Ozs7Ozs7O0dBQzlCLENBQUM7QUFDRixTQUFPLEtBQUssQ0FBQztDQUNkOztBQUVELFFBQVEsQ0FBQyxPQUFPLEVBQUUsWUFBWTtBQUM1QixJQUFFLENBQUMsZ0NBQWdDLEVBQUUsWUFBWTtBQUMvQyxRQUFJLENBQUMsR0FBRyxTQUFTLENBQUMsRUFBQyxNQUFNLEVBQUUsV0FBVyxFQUFDLENBQUMsQ0FBQztBQUN6QyxLQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDbkMsS0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0dBQzNCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQyw0Q0FBNEMsRUFBRTtRQUMzQyxDQUFDLGVBQ0EsR0FBRyxFQUFFLElBQUk7Ozs7O0FBRFYsV0FBQyxHQUFHLFNBQVMsRUFBRTs7MkNBQ0ssQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsTUFBTSxFQUFFLEVBQUMsbUJBQW1CLEVBQUUsRUFBRSxFQUFDLENBQUM7Ozs7O0FBQXpFLGFBQUc7QUFBRSxjQUFJOztBQUNkLGFBQUcsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNqQyxjQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBQyxXQUFXLEVBQUUsS0FBSyxFQUFDLEVBQUMsQ0FBQyxDQUFDO0FBQzVFLFdBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQzs7Ozs7OztHQUNqQyxDQUFDLENBQUM7QUFDSCxJQUFFLENBQUMscURBQXFELEVBQUU7UUFDcEQsQ0FBQyxpQkFDQSxHQUFHLEVBQUUsSUFBSTs7Ozs7QUFEVixXQUFDLEdBQUcsU0FBUyxFQUFFOzsyQ0FDSyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxNQUFNLEVBQUUsRUFBQyxtQkFBbUIsRUFBRSxFQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUMsRUFBQyxDQUFDOzs7OztBQUF2RixhQUFHO0FBQUUsY0FBSTs7QUFDZCxhQUFHLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDakMsY0FBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsMENBQTBDLENBQUMsQ0FBQztBQUM1RCxXQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7Ozs7Ozs7R0FDakMsQ0FBQyxDQUFDO0FBQ0gsVUFBUSxDQUFDLGdCQUFnQixFQUFFLFlBQVk7QUFDckMsTUFBRSxDQUFDLDBDQUEwQyxFQUFFO1VBQ3pDLENBQUM7Ozs7QUFBRCxhQUFDLEdBQUcsU0FBUyxDQUFDLEVBQUMsU0FBUyxFQUFFLEtBQUssRUFBQyxDQUFDOztBQUNyQyxhQUFDLENBQUMsY0FBYyxDQUFDLDJEQUEyRCxDQUFDLENBQzNFLE1BQU0sQ0FBQyxHQUFHLENBQUMsNERBQTRELENBQUMsQ0FBQzs7Ozs7OztLQUM1RSxDQUFDLENBQUM7QUFDSCxNQUFFLENBQUMsc0RBQXNELEVBQUU7VUFDckQsQ0FBQzs7OztBQUFELGFBQUMsR0FBRyxTQUFTLENBQUMsRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUM7O0FBQ3JDLGFBQUMsQ0FBQyxjQUFjLENBQUMsdUNBQXVDLENBQUMsQ0FDdkQsTUFBTSxDQUFDLEdBQUcsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDOzs7Ozs7O0tBQzVFLENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxxREFBcUQsRUFBRTtVQUNwRCxDQUFDLEVBSUQsTUFBTTs7OztBQUpOLGFBQUMsR0FBRyxTQUFTLENBQUMsRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUM7O0FBQ3JDLGFBQUMsQ0FBQyxjQUFjLENBQUMscUNBQXFDLENBQUMsQ0FDckQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDOztBQUVqRCxrQkFBTSxHQUFHLENBQUMsQ0FBQyxjQUFjLENBQUMsaUJBQWlCLENBQUM7O0FBQ2hELGtCQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDOzs7Ozs7O0tBQzNELENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxnRUFBZ0UsRUFBRTtVQUMvRCxDQUFDLEVBQ0QsQ0FBQzs7OztBQURELGFBQUMsR0FBRyxTQUFTLEVBQUU7QUFDZixhQUFDOztBQUNMLGdCQUFJO0FBQ0YsZUFBQyxDQUFDLGNBQWMsQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO2FBQzNELENBQUMsT0FBTyxHQUFHLEVBQUU7QUFDWixlQUFDLEdBQUcsR0FBRyxDQUFDO2FBQ1Q7QUFDRCxrQkFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNoQixhQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsb0JBQW9CLENBQUMsQ0FBQzs7Ozs7OztLQUNoRCxDQUFDLENBQUM7QUFDSCxNQUFFLENBQUMsNkVBQTZFLEVBQUU7VUFDNUUsQ0FBQyxFQUNELE1BQU07Ozs7QUFETixhQUFDLEdBQUcsU0FBUyxFQUFFO0FBQ2Ysa0JBQU0sR0FBRyxDQUFDLENBQUMsY0FBYyxDQUFDLGdCQUFnQixDQUFDOztBQUUvQyxrQkFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQzs7Ozs7OztLQUN0QixDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7QUFDSCxVQUFRLENBQUMsZ0JBQWdCLEVBQUUsWUFBWTtBQUNyQyxNQUFFLENBQUMsb0NBQW9DLEVBQUU7VUFDbkMsQ0FBQyxpQkFDQSxHQUFHLEVBQUUsSUFBSTs7Ozs7QUFEVixhQUFDLEdBQUcsU0FBUyxFQUFFOzs2Q0FDSyxDQUFDLENBQUMsS0FBSyxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUM7Ozs7O0FBQTVDLGVBQUc7QUFBRSxnQkFBSTs7QUFDZCxlQUFHLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDakMsZ0JBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBQyxHQUFHLEVBQUUsS0FBSyxFQUFDLEVBQUMsQ0FBQyxDQUFDOzs7Ozs7O0tBQ25ELENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxrQ0FBa0MsRUFBRTtVQUNqQyxDQUFDOzs7O0FBQUQsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQzs7QUFDckMsYUFBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLGlCQUFpQixDQUFDLENBQUM7Ozs7Ozs7S0FDaEYsQ0FBQyxDQUFDO0FBQ0gsTUFBRSxDQUFDLHdDQUF3QyxFQUFFO1VBQ3ZDLENBQUMsaUJBQ0EsR0FBRyxFQUFFLElBQUk7Ozs7O0FBRFYsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQzs7NkNBQ2IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsRUFBRSxLQUFLLENBQUM7Ozs7O0FBQXRELGVBQUc7QUFBRSxnQkFBSTs7QUFDZCxlQUFHLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDakMsZ0JBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBQyxPQUFPLEVBQUUsbUJBQW1CLEVBQUMsRUFBQyxDQUFDLENBQUM7Ozs7Ozs7S0FDdEUsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0FBQ0gsVUFBUSxDQUFDLDBCQUEwQixFQUFFLFlBQVk7QUFDL0MsUUFBSSxDQUFDLFlBQUEsQ0FBQztBQUNOLFVBQU0sQ0FBQyxZQUFZO0FBQ2pCLE9BQUMsR0FBRyxTQUFTLEVBQUUsQ0FBQztLQUNqQixDQUFDLENBQUM7QUFDSCxNQUFFLENBQUMscUVBQXFFLEVBQUU7VUFDcEUsY0FBYzs7Ozs7NkNBQVMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLEVBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFDLENBQUM7OztBQUFqRiwwQkFBYzs7QUFDbEIsMEJBQWMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN0QywwQkFBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUFDOzs7Ozs7O0tBQ2hILENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyx5RkFBeUYsRUFBRTt5QkFDdkYsYUFBYSxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQzlDLGVBQWU7Ozs7Ozs2Q0FEeUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLEVBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBQyxDQUFDOzs7OztBQUFqSix5QkFBYTtBQUFFLDJCQUFlO0FBQUUsMkJBQWU7QUFDOUMsMkJBQWUsR0FBRyxFQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFDOztBQUNuRSx5QkFBYSxDQUFDLE1BQU0sQ0FBQyxHQUFHLGNBQ25CLGVBQWU7QUFDbEIsa0JBQUksRUFBRSxRQUFRO0FBQ2QsZ0JBQUUsRUFBRSxHQUFHO2VBQ1AsQ0FBQztBQUNILDJCQUFlLENBQUMsTUFBTSxDQUFDLEdBQUcsY0FDckIsZUFBZTtBQUNsQixrQkFBSSxFQUFFLFVBQVU7QUFDaEIsZ0JBQUUsRUFBRSxHQUFHO2VBQ1AsQ0FBQztBQUNILDJCQUFlLENBQUMsTUFBTSxDQUFDLEdBQUcsY0FDckIsZUFBZTtBQUNsQixrQkFBSSxFQUFFLFVBQVU7QUFDaEIsZ0JBQUUsRUFBRSxHQUFHO2VBQ1AsQ0FBQzs7Ozs7OztLQUNKLENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxnREFBZ0QsRUFBRTt5QkFDOUMsYUFBYTs7Ozs7OzZDQUFVLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUM7Ozs7O0FBQWpHLHlCQUFhOztBQUNsQix5QkFBYSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUM7QUFDdkIsb0JBQU0sRUFBRSxHQUFHO0FBQ1gsc0JBQVEsRUFBRSxTQUFTO0FBQ25CLHNCQUFRLEVBQUUsU0FBUztBQUNuQixrQkFBSSxFQUFFLFFBQVE7QUFDZCxnQkFBRSxFQUFFLEdBQUc7YUFDUixDQUFDLENBQUM7Ozs7Ozs7S0FDSixDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7QUFDSCxVQUFRLENBQUMsZUFBZSxFQUFFLFlBQVk7QUFDcEMsTUFBRSxDQUFDLG1DQUFtQyxFQUFFO1VBQ2xDLENBQUMsRUFDRCxHQUFHOzs7O0FBREgsYUFBQyxHQUFHLFNBQVMsRUFBRTs7NkNBQ0gsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDOzs7QUFBdkMsZUFBRzs7QUFDUCxlQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDOzs7Ozs7O0tBQzlCLENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxrQ0FBa0MsRUFBRTtVQUNqQyxDQUFDOzs7O0FBQUQsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQzs7QUFDckMsYUFBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLGlCQUFpQixDQUFDLENBQUM7Ozs7Ozs7S0FDbEYsQ0FBQyxDQUFDO0FBQ0gsTUFBRSxDQUFDLG1DQUFtQyxFQUFFO1VBQ2xDLENBQUMsRUFDRCxDQUFDOzs7O0FBREQsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQztBQUNqQyxhQUFDLEdBQUcsSUFBSTs7OzZDQUVKLENBQUMsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLEVBQUUsS0FBSyxDQUFDOzs7Ozs7Ozs7O0FBRTNDLGFBQUMsaUJBQU0sQ0FBQzs7O0FBRVYsa0JBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEIsYUFBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7Ozs7Ozs7S0FDL0MsQ0FBQyxDQUFDO0FBQ0gsTUFBRSxDQUFDLDBFQUEwRSxFQUFFO1VBQ3pFLENBQUMsRUFDRCxDQUFDOzs7O0FBREQsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQztBQUNqQyxhQUFDLEdBQUcsSUFBSTs7OzZDQUVKLENBQUMsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLEVBQUUsS0FBSyxDQUFDOzs7Ozs7Ozs7O0FBRTNDLGFBQUMsaUJBQU0sQ0FBQzs7O0FBRVYsa0JBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEIsYUFBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDLENBQUM7Ozs7Ozs7S0FDM0MsQ0FBQyxDQUFDO0FBQ0gsTUFBRSxDQUFDLDhDQUE4QyxFQUFFO1VBQzdDLENBQUMsRUFDRCxDQUFDOzs7O0FBREQsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQztBQUNqQyxhQUFDLEdBQUcsSUFBSTs7OzZDQUVKLENBQUMsQ0FBQyxPQUFPLENBQUMsNkJBQTZCLEVBQUUsS0FBSyxDQUFDOzs7Ozs7Ozs7O0FBRXJELGFBQUMsaUJBQU0sQ0FBQzs7O0FBRVYsa0JBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEIsYUFBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLHNCQUFzQixDQUFDLENBQUM7Ozs7Ozs7S0FDbEQsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0FBQ0gsVUFBUSxDQUFDLGVBQWUsRUFBRSxZQUFZO0FBQ3BDLE1BQUUsQ0FBQyxtREFBbUQsRUFBRTtVQUNsRCxDQUFDLCtCQUNBLEdBQUcsRUFBRSxHQUFHOzs7OztBQURULGFBQUMsR0FBRyxTQUFTLEVBQUU7MkJBQ0YsV0FBVyxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUM7O0FBQXpDLGVBQUc7QUFBRSxlQUFHOzs2Q0FDUCxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7OztBQUM3QixlQUFHLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUNBQWlDLENBQUMsQ0FBQztBQUM1RSxlQUFHLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDL0IsZUFBRyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBQyxHQUFHLEVBQUUsS0FBSyxFQUFDLEVBQUMsQ0FBQyxDQUFDOzs7Ozs7O0tBQzNELENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyx5REFBeUQsRUFBRTtVQUN4RCxDQUFDLGlDQUNBLEdBQUcsRUFBRSxHQUFHOzs7OztBQURULGFBQUMsR0FBRyxTQUFTLENBQUMsRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUM7NEJBQ3BCLFdBQVcsQ0FBQyxvQkFBb0IsRUFBRSxLQUFLLENBQUM7O0FBQXBELGVBQUc7QUFBRSxlQUFHOzs2Q0FDUCxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7OztBQUM3QixlQUFHLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7Ozs7Ozs7S0FDekUsQ0FBQyxDQUFDO0FBQ0gsTUFBRSxDQUFDLDJEQUEyRCxFQUFFO1VBQzFELENBQUMsaUNBQ0EsR0FBRyxFQUFFLEdBQUc7Ozs7O0FBRFQsYUFBQyxHQUFHLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQzs0QkFDcEIsV0FBVyxDQUFDLHVDQUF1QyxFQUFFLE1BQU0sQ0FBQzs7QUFBeEUsZUFBRztBQUFFLGVBQUc7OzZDQUNQLENBQUMsQ0FBQyxXQUFXLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQzs7O0FBQzdCLGVBQUcsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQzs7Ozs7OztLQUN6RSxDQUFDLENBQUM7QUFDSCxNQUFFLENBQUMsMERBQTBELEVBQUU7VUFDekQsQ0FBQyxpQ0FDQSxHQUFHLEVBQUUsR0FBRzs7Ozs7QUFEVCxhQUFDLEdBQUcsU0FBUyxDQUFDLEVBQUMsU0FBUyxFQUFFLEtBQUssRUFBQyxDQUFDOzRCQUNwQixXQUFXLENBQUMsZ0JBQWdCLEVBQUUsS0FBSyxDQUFDOztBQUFoRCxlQUFHO0FBQUUsZUFBRzs7NkNBQ1AsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDOzs7QUFDN0IsZUFBRyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBQyxLQUFLLEVBQUMsS0FBSyxFQUFDLEVBQUMsQ0FBQyxDQUFDOzs7Ozs7O0tBQzVELENBQUMsQ0FBQztBQUNILE1BQUUsQ0FBQyxnQ0FBZ0MsRUFBRTtVQUMvQixDQUFDLGlDQUNBLEdBQUcsRUFBRSxHQUFHOzs7OztBQURULGFBQUMsR0FBRyxTQUFTLENBQUMsRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUM7NEJBQ3BCLFdBQVcsQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDOztBQUEzQyxlQUFHO0FBQUUsZUFBRzs7NkNBQ1AsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDOzs7QUFDN0IsZUFBRyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQy9CLGVBQUcsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUMsT0FBTyxFQUFFLHNCQUFzQixFQUFDLEVBQUMsQ0FBQyxDQUFDOzs7Ozs7O0tBQ2hGLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2pzb253cC1wcm94eS9wcm94eS1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRyYW5zcGlsZTptb2NoYVxyXG4vKiBnbG9iYWwgZGVzY3JpYmU6dHJ1ZSwgaXQ6dHJ1ZSAqL1xyXG5cclxuaW1wb3J0IHsgSldQcm94eSB9IGZyb20gJy4uLy4uJztcclxuaW1wb3J0IHJlcXVlc3QgZnJvbSAnLi9tb2NrLXJlcXVlc3QnO1xyXG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcclxuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xyXG5cclxuXHJcbmNvbnN0IHNob3VsZCA9IGNoYWkuc2hvdWxkKCk7XHJcbmNoYWkudXNlKGNoYWlBc1Byb21pc2VkKTtcclxuXHJcbmZ1bmN0aW9uIGJ1aWxkUmVxUmVzICh1cmwsIG1ldGhvZCwgYm9keSkge1xyXG4gIGxldCByZXEgPSB7b3JpZ2luYWxVcmw6IHVybCwgbWV0aG9kLCBib2R5fTtcclxuICBsZXQgcmVzID0ge307XHJcbiAgcmVzLmhlYWRlcnMgPSB7fTtcclxuICByZXMuc2V0ID0gKGssIHYpID0+IHsgcmVzW2tdID0gdjsgfTtcclxuICByZXMuc3RhdHVzID0gKGNvZGUpID0+IHtcclxuICAgIHJlcy5zZW50Q29kZSA9IGNvZGU7XHJcbiAgICByZXR1cm4gcmVzO1xyXG4gIH07XHJcbiAgcmVzLnNlbmQgPSAoYm9keSkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYm9keSA9IEpTT04ucGFyc2UoYm9keSk7XHJcbiAgICB9IGNhdGNoIChlKSB7fVxyXG4gICAgcmVzLnNlbnRCb2R5ID0gYm9keTtcclxuICB9O1xyXG4gIHJldHVybiBbcmVxLCByZXNdO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtb2NrUHJveHkgKG9wdHMgPSB7fSkge1xyXG4gIGxldCBwcm94eSA9IG5ldyBKV1Byb3h5KG9wdHMpO1xyXG4gIHByb3h5LnJlcXVlc3QgPSBhc3luYyBmdW5jdGlvbiAoLi4uYXJncykge1xyXG4gICAgcmV0dXJuIGF3YWl0IHJlcXVlc3QoLi4uYXJncyk7XHJcbiAgfTtcclxuICByZXR1cm4gcHJveHk7XHJcbn1cclxuXHJcbmRlc2NyaWJlKCdwcm94eScsIGZ1bmN0aW9uICgpIHtcclxuICBpdCgnc2hvdWxkIG92ZXJyaWRlIGRlZmF1bHQgcGFyYW1zJywgZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IGogPSBtb2NrUHJveHkoe3NlcnZlcjogJzEyNy4wLjAuMid9KTtcclxuICAgIGouc2VydmVyLnNob3VsZC5lcXVhbCgnMTI3LjAuMC4yJyk7XHJcbiAgICBqLnBvcnQuc2hvdWxkLmVxdWFsKDQ0NDQpO1xyXG4gIH0pO1xyXG4gIGl0KCdzaG91bGQgc2F2ZSBzZXNzaW9uIGlkIG9uIHNlc3Npb24gY3JlYXRpb24nLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgaiA9IG1vY2tQcm94eSgpO1xyXG4gICAgbGV0IFtyZXMsIGJvZHldID0gYXdhaXQgai5wcm94eSgnL3Nlc3Npb24nLCAnUE9TVCcsIHtkZXNpcmVkQ2FwYWJpbGl0aWVzOiB7fX0pO1xyXG4gICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDIwMCk7XHJcbiAgICBib2R5LnNob3VsZC5lcWwoe3N0YXR1czogMCwgc2Vzc2lvbklkOiAnMTIzJywgdmFsdWU6IHticm93c2VyTmFtZTogJ2Jvbyd9fSk7XHJcbiAgICBqLnNlc3Npb25JZC5zaG91bGQuZXF1YWwoJzEyMycpO1xyXG4gIH0pO1xyXG4gIGl0KCdzaG91bGQgc2F2ZSBzZXNzaW9uIGlkIG9uIHNlc3Npb24gY3JlYXRpb24gd2l0aCAzMDMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgaiA9IG1vY2tQcm94eSgpO1xyXG4gICAgbGV0IFtyZXMsIGJvZHldID0gYXdhaXQgai5wcm94eSgnL3Nlc3Npb24nLCAnUE9TVCcsIHtkZXNpcmVkQ2FwYWJpbGl0aWVzOiB7cmVkaXJlY3Q6IHRydWV9fSk7XHJcbiAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoMzAzKTtcclxuICAgIGJvZHkuc2hvdWxkLmVxbCgnaHR0cDovL2xvY2FsaG9zdDo0NDQ0L3dkL2h1Yi9zZXNzaW9uLzEyMycpO1xyXG4gICAgai5zZXNzaW9uSWQuc2hvdWxkLmVxdWFsKCcxMjMnKTtcclxuICB9KTtcclxuICBkZXNjcmliZSgnZ2V0VXJsRm9yUHJveHknLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpdCgnc2hvdWxkIG1vZGlmeSBzZXNzaW9uIGlkLCBob3N0LCBhbmQgcG9ydCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgai5nZXRVcmxGb3JQcm94eSgnaHR0cDovL2hvc3QuY29tOjEyMzQvd2QvaHViL3Nlc3Npb24vNDU2L2VsZW1lbnQvMjAwL3ZhbHVlJylcclxuICAgICAgIC5zaG91bGQuZXFsKCdodHRwOi8vbG9jYWxob3N0OjQ0NDQvd2QvaHViL3Nlc3Npb24vMTIzL2VsZW1lbnQvMjAwL3ZhbHVlJyk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgcHJlcGVuZCBzY2hlbWUsIGhvc3QgYW5kIHBvcnQgaWYgbm90IHByb3ZpZGVkJywgYXN5bmMgZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSh7c2Vzc2lvbklkOiAnMTIzJ30pO1xyXG4gICAgICBqLmdldFVybEZvclByb3h5KCcvd2QvaHViL3Nlc3Npb24vNDU2L2VsZW1lbnQvMjAwL3ZhbHVlJylcclxuICAgICAgIC5zaG91bGQuZXFsKCdodHRwOi8vbG9jYWxob3N0OjQ0NDQvd2QvaHViL3Nlc3Npb24vMTIzL2VsZW1lbnQvMjAwL3ZhbHVlJyk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgd29yayB3aXRoIHVybHMgd2hpY2ggZG8gbm90IGhhdmUgc2Vzc2lvbiBpZHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XHJcbiAgICAgIGouZ2V0VXJsRm9yUHJveHkoJ2h0dHA6Ly9ob3N0LmNvbToxMjM0L3dkL2h1Yi9zZXNzaW9uJylcclxuICAgICAgIC5zaG91bGQuZXFsKCdodHRwOi8vbG9jYWxob3N0OjQ0NDQvd2QvaHViL3Nlc3Npb24nKTtcclxuXHJcbiAgICAgIGxldCBuZXdVcmwgPSBqLmdldFVybEZvclByb3h5KCcvd2QvaHViL3Nlc3Npb24nKTtcclxuICAgICAgbmV3VXJsLnNob3VsZC5lcWwoJ2h0dHA6Ly9sb2NhbGhvc3Q6NDQ0NC93ZC9odWIvc2Vzc2lvbicpO1xyXG4gICAgfSk7XHJcbiAgICBpdCgnc2hvdWxkIHRocm93IGFuIGVycm9yIGlmIHVybCByZXF1aXJlcyBhIHNlc3Npb25JZCBidXQgaXRzIG51bGwnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KCk7XHJcbiAgICAgIGxldCBlO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGouZ2V0VXJsRm9yUHJveHkoJy93ZC9odWIvc2Vzc2lvbi80NTYvZWxlbWVudC8yMDAvdmFsdWUnKTtcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgZSA9IGVycjtcclxuICAgICAgfVxyXG4gICAgICBzaG91bGQuZXhpc3QoZSk7XHJcbiAgICAgIGUubWVzc2FnZS5zaG91bGQuY29udGFpbignd2l0aG91dCBzZXNzaW9uIGlkJyk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgbm90IHRocm93IGFuIGVycm9yIGlmIHVybCBkb2VzIG5vdCByZXF1aXJlIGEgc2Vzc2lvbiBpZCBhbmQgaXRzIG51bGwnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KCk7XHJcbiAgICAgIGxldCBuZXdVcmwgPSBqLmdldFVybEZvclByb3h5KCcvd2QvaHViL3N0YXR1cycpO1xyXG5cclxuICAgICAgc2hvdWxkLmV4aXN0KG5ld1VybCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuICBkZXNjcmliZSgnc3RyYWlnaHQgcHJveHknLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSBwcm94eSBzdHJhaWdodCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoKTtcclxuICAgICAgbGV0IFtyZXMsIGJvZHldID0gYXdhaXQgai5wcm94eSgnL3N0YXR1cycsICdHRVQnKTtcclxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDIwMCk7XHJcbiAgICAgIGJvZHkuc2hvdWxkLmVxbCh7c3RhdHVzOiAwLCB2YWx1ZToge2ZvbzogJ2Jhcid9fSk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgcGFzcyBhbG9uZyByZXF1ZXN0IGVycm9ycycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgai5wcm94eSgnL2JhZHVybCcsICdHRVQnKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoXCJDb3VsZCBub3QgcHJveHlcIik7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgcHJveHkgZXJyb3IgcmVzcG9uc2VzIGFuZCBjb2RlcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgbGV0IFtyZXMsIGJvZHldID0gYXdhaXQgai5wcm94eSgnL2VsZW1lbnQvYmFkL3RleHQnLCAnR0VUJyk7XHJcbiAgICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg1MDApO1xyXG4gICAgICBib2R5LnNob3VsZC5lcWwoe3N0YXR1czogMTEsIHZhbHVlOiB7bWVzc2FnZTogJ0ludmlzaWJsZSBlbGVtZW50J319KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG4gIGRlc2NyaWJlKCdnZXRUaW1lb3V0UmVxdWVzdE9iamVjdHMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgajtcclxuICAgIGJlZm9yZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGogPSBtb2NrUHJveHkoKTtcclxuICAgIH0pO1xyXG4gICAgaXQoJ3Nob3VsZCB0YWtlIFczQyBpbnB1dHMgYW5kIHByb2R1Y2UgTUpTT05XUCArIFczQyBjb21wYXRpYmxlIG9iamVjdHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCB0aW1lb3V0T2JqZWN0cyA9IGF3YWl0IGouZ2V0VGltZW91dFJlcXVlc3RPYmplY3RzKHtwcm90b2NvbDogJ1czQycsIHNjcmlwdDogMTAwfSk7XHJcbiAgICAgIHRpbWVvdXRPYmplY3RzLmxlbmd0aC5zaG91bGQuZXF1YWwoMSk7XHJcbiAgICAgIHRpbWVvdXRPYmplY3RzWzBdLnNob3VsZC5lcWwoe3NjcmlwdDogMTAwLCBwYWdlTG9hZDogdW5kZWZpbmVkLCBpbXBsaWNpdDogdW5kZWZpbmVkLCB0eXBlOiAnc2NyaXB0JywgbXM6IDEwMH0pO1xyXG4gICAgfSk7XHJcbiAgICBpdCgnc2hvdWxkIHRha2UgbXVsdGlwbGUgVzNDIHRpbWVvdXRzIGFuZCBwcm9kdWNlIG11bHRpcGxlIE1KU09OV1AgKyBXM0MgY29tcGF0aWJsZSBvYmplY3RzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgW3NjcmlwdFRpbWVvdXQsIHBhZ2VMb2FkVGltZW91dCwgaW1wbGljaXRUaW1lb3V0XSA9IGF3YWl0IGouZ2V0VGltZW91dFJlcXVlc3RPYmplY3RzKHtwcm90b2NvbDogJ1czQycsIHNjcmlwdDogMTAwLCBwYWdlTG9hZDogMjAwLCBpbXBsaWNpdDogMzAwfSk7XHJcbiAgICAgIGNvbnN0IGV4cGVjdGVkT2JqQmFzZSA9IHtzY3JpcHQ6IDEwMCwgcGFnZUxvYWQ6IDIwMCwgaW1wbGljaXQ6IDMwMH07XHJcbiAgICAgIHNjcmlwdFRpbWVvdXQuc2hvdWxkLmVxbCh7XHJcbiAgICAgICAgLi4uZXhwZWN0ZWRPYmpCYXNlLFxyXG4gICAgICAgIHR5cGU6ICdzY3JpcHQnLFxyXG4gICAgICAgIG1zOiAxMDAsXHJcbiAgICAgIH0pO1xyXG4gICAgICBwYWdlTG9hZFRpbWVvdXQuc2hvdWxkLmVxbCh7XHJcbiAgICAgICAgLi4uZXhwZWN0ZWRPYmpCYXNlLFxyXG4gICAgICAgIHR5cGU6ICdwYWdlTG9hZCcsXHJcbiAgICAgICAgbXM6IDIwMCxcclxuICAgICAgfSk7XHJcbiAgICAgIGltcGxpY2l0VGltZW91dC5zaG91bGQuZXFsKHtcclxuICAgICAgICAuLi5leHBlY3RlZE9iakJhc2UsXHJcbiAgICAgICAgdHlwZTogJ2ltcGxpY2l0JyxcclxuICAgICAgICBtczogMzAwLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgVzNDIHRpbWVvdXRzIGZyb20gTUpTT05XUCBpbnB1dHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBbdGltZW91dE9iamVjdF0gPSBhd2FpdCBqLmdldFRpbWVvdXRSZXF1ZXN0T2JqZWN0cyh7cHJvdG9jb2w6ICdNSlNPTldQJywgdHlwZTogJ3NjcmlwdCcsIG1zOiAyMDB9KTtcclxuICAgICAgdGltZW91dE9iamVjdC5zaG91bGQuZXFsKHtcclxuICAgICAgICBzY3JpcHQ6IDIwMCxcclxuICAgICAgICBwYWdlTG9hZDogdW5kZWZpbmVkLFxyXG4gICAgICAgIGltcGxpY2l0OiB1bmRlZmluZWQsXHJcbiAgICAgICAgdHlwZTogJ3NjcmlwdCcsXHJcbiAgICAgICAgbXM6IDIwMCxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuICBkZXNjcmliZSgnY29tbWFuZCBwcm94eScsIGZ1bmN0aW9uICgpIHtcclxuICAgIGl0KCdzaG91bGQgc3VjY2Vzc2Z1bGx5IHByb3h5IGNvbW1hbmQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KCk7XHJcbiAgICAgIGxldCByZXMgPSBhd2FpdCBqLmNvbW1hbmQoJy9zdGF0dXMnLCAnR0VUJyk7XHJcbiAgICAgIHJlcy5zaG91bGQuZXFsKHtmb286ICdiYXInfSk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgcGFzcyBhbG9uZyByZXF1ZXN0IGVycm9ycycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgai5jb21tYW5kKCcvYmFkdXJsJywgJ0dFVCcpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aChcIkNvdWxkIG5vdCBwcm94eVwiKTtcclxuICAgIH0pO1xyXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyB3aGVuIGEgY29tbWFuZCBmYWlscycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgbGV0IGUgPSBudWxsO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGouY29tbWFuZCgnL2VsZW1lbnQvYmFkL3RleHQnLCAnR0VUJyk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGUgPSBlcnI7XHJcbiAgICAgIH1cclxuICAgICAgc2hvdWxkLmV4aXN0KGUpO1xyXG4gICAgICBlLm1lc3NhZ2Uuc2hvdWxkLmNvbnRhaW4oJ0ludmlzaWJsZSBlbGVtZW50Jyk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgdGhyb3cgd2hlbiBhIGNvbW1hbmQgZmFpbHMgd2l0aCBhIDIwMCBiZWNhdXNlIHRoZSBzdGF0dXMgaXMgbm90IDAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XHJcbiAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBqLmNvbW1hbmQoJy9lbGVtZW50LzIwMC90ZXh0JywgJ0dFVCcpO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBlID0gZXJyO1xyXG4gICAgICB9XHJcbiAgICAgIHNob3VsZC5leGlzdChlKTtcclxuICAgICAgZS5lcnJvci5zaG91bGQuZXFsKCdlbGVtZW50IG5vdCB2aXNpYmxlJyk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgdGhyb3cgd2hlbiBhIGNvbW1hbmQgZmFpbHMgd2l0aCBhIDEwMCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgbGV0IGUgPSBudWxsO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGouY29tbWFuZCgnL3Nlc3Npb24vYmFkY2hyb21lL25vY2hyb21lJywgJ0dFVCcpO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBlID0gZXJyO1xyXG4gICAgICB9XHJcbiAgICAgIHNob3VsZC5leGlzdChlKTtcclxuICAgICAgZS5tZXNzYWdlLnNob3VsZC5jb250YWluKCdjaHJvbWUgbm90IHJlYWNoYWJsZScpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbiAgZGVzY3JpYmUoJ3JlcS9yZXMgcHJveHknLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSBwcm94eSB2aWEgcmVxIGFuZCBzZW5kIHRvIHJlcycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoKTtcclxuICAgICAgbGV0IFtyZXEsIHJlc10gPSBidWlsZFJlcVJlcygnL3N0YXR1cycsICdHRVQnKTtcclxuICAgICAgYXdhaXQgai5wcm94eVJlcVJlcyhyZXEsIHJlcyk7XHJcbiAgICAgIHJlcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXS5zaG91bGQuZXF1YWwoJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnKTtcclxuICAgICAgcmVzLnNlbnRDb2RlLnNob3VsZC5lcXVhbCgyMDApO1xyXG4gICAgICByZXMuc2VudEJvZHkuc2hvdWxkLmVxbCh7c3RhdHVzOiAwLCB2YWx1ZToge2ZvbzogJ2Jhcid9fSk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgcmV3cml0ZSB0aGUgaW5uZXIgc2Vzc2lvbiBpZCBzbyBpdCBkb2VzbnQgY2hhbmdlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSh7c2Vzc2lvbklkOiAnMTIzJ30pO1xyXG4gICAgICBsZXQgW3JlcSwgcmVzXSA9IGJ1aWxkUmVxUmVzKCcvZWxlbWVudC8yMDAvdmFsdWUnLCAnR0VUJyk7XHJcbiAgICAgIGF3YWl0IGoucHJveHlSZXFSZXMocmVxLCByZXMpO1xyXG4gICAgICByZXMuc2VudEJvZHkuc2hvdWxkLmVxbCh7c3RhdHVzOiAwLCB2YWx1ZTogJ2Zvb2JhcicsIHNlc3Npb25JZDogJzEyMyd9KTtcclxuICAgIH0pO1xyXG4gICAgaXQoJ3Nob3VsZCByZXdyaXRlIHRoZSBpbm5lciBzZXNzaW9uIGlkIHdpdGggc2Vzc2lvbklkIGluIHVybCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGogPSBtb2NrUHJveHkoe3Nlc3Npb25JZDogJzEyMyd9KTtcclxuICAgICAgbGV0IFtyZXEsIHJlc10gPSBidWlsZFJlcVJlcygnL3dkL2h1Yi9zZXNzaW9uLzQ1Ni9lbGVtZW50LzIwMC92YWx1ZScsICdQT1NUJyk7XHJcbiAgICAgIGF3YWl0IGoucHJveHlSZXFSZXMocmVxLCByZXMpO1xyXG4gICAgICByZXMuc2VudEJvZHkuc2hvdWxkLmVxbCh7c3RhdHVzOiAwLCB2YWx1ZTogJ2Zvb2JhcicsIHNlc3Npb25JZDogJzQ1Nid9KTtcclxuICAgIH0pO1xyXG4gICAgaXQoJ3Nob3VsZCBwYXNzIHRocm91Z2ggdXJscyB0aGF0IGRvIG5vdCByZXF1aXJlIHNlc3Npb24gSURzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgaiA9IG1vY2tQcm94eSh7c2Vzc2lvbklkOiAnMTIzJ30pO1xyXG4gICAgICBsZXQgW3JlcSwgcmVzXSA9IGJ1aWxkUmVxUmVzKCcvd2QvaHViL3N0YXR1cycsICdHRVQnKTtcclxuICAgICAgYXdhaXQgai5wcm94eVJlcVJlcyhyZXEsIHJlcyk7XHJcbiAgICAgIHJlcy5zZW50Qm9keS5zaG91bGQuZXFsKHtzdGF0dXM6IDAsIHZhbHVlOiB7J2Zvbyc6J2Jhcid9fSk7XHJcbiAgICB9KTtcclxuICAgIGl0KCdzaG91bGQgcHJveHkgc3RyYW5nZSByZXNwb25zZXMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBqID0gbW9ja1Byb3h5KHtzZXNzaW9uSWQ6ICcxMjMnfSk7XHJcbiAgICAgIGxldCBbcmVxLCByZXNdID0gYnVpbGRSZXFSZXMoJy9ub2Nocm9tZScsICdHRVQnKTtcclxuICAgICAgYXdhaXQgai5wcm94eVJlcVJlcyhyZXEsIHJlcyk7XHJcbiAgICAgIHJlcy5zZW50Q29kZS5zaG91bGQuZXF1YWwoMTAwKTtcclxuICAgICAgcmVzLnNlbnRCb2R5LnNob3VsZC5lcWwoe3N0YXR1czogMCwgdmFsdWU6IHttZXNzYWdlOiAnY2hyb21lIG5vdCByZWFjaGFibGUnfX0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
